import"./header-fRl19Khu.js";import"./navbar-Fsj5A7cu.js";const s={username:"John Doe",time:1727458711867,text:"Welcome to comment box challenge!",counter:1,parentCounter:0,comments:{0:{username:"User 1",text:"You can reply to the comments or edit the existing comments",counter:1,parentCounter:0,comments:{0:{username:"User 2",text:"You can reply nested or delete any comment. Refresh & see the changes persist",counter:0,parentCounter:0,comments:{}}}}}},m=localStorage.getItem("state"),S=m?JSON.parse(m):{initialCommentState:s,comments:{...s.comments}},d=document.querySelector("#comment-template");function p({username:e,text:t}){const o=d.content.cloneNode(!0);return o.querySelector(".username").textContent=e,o.querySelector(".comment-text").innerText=t,o.querySelector(".user-info").classList.remove("hide"),i(o),o}function x(){const e=d.content.cloneNode(!0);return e.querySelector(".username-input").classList.remove("hide"),h(e),e}function i(e){const t=e.querySelector(".comment-text");t.contentEditable=!1,t.classList.remove("editable"),e.querySelector(".reply").classList.remove("hide"),e.querySelector(".delete").classList.remove("hide"),e.querySelector(".edit").classList.remove("hide"),e.querySelector(".submit").classList.add("hide"),e.querySelector(".cancel").classList.add("hide")}function L(e){const t=e.querySelector(".comment-text");t.contentEditable=!0,t.classList.add("editable"),t.focus(),e.querySelector(".reply").classList.add("hide"),e.querySelector(".delete").classList.add("hide"),e.querySelector(".edit").classList.add("hide"),e.querySelector(".submit").classList.remove("hide"),e.querySelector(".cancel").classList.remove("hide")}function h(e){e.querySelector(".comment-text").contentEditable=!0,e.querySelector(".comment-text").classList.add("editable"),e.querySelector(".comment-text").focus(),e.querySelector(".username-input").classList.remove("hide"),e.querySelector(".cancel").classList.remove("hide"),e.querySelector(".submit").classList.remove("hide")}const a=document.querySelector("#commentContainer");document.querySelector("#comment-template");const v=document.querySelector("#reset");let n;function l(e,t,o){e.querySelector(":scope > .sub-comments").appendChild(p({username:t.username,text:t.text}));const r=e.querySelector(":scope > .sub-comments > .comment-wrapper:last-child");return r.querySelector(".profile-pic").src=`https://i.pravatar.cc/32?u=${t.username}`,r.querySelector(".reply").addEventListener("click",()=>{r.querySelector(":scope > .sub-comments > .new-comment")||f(r,t)}),o&&(r.querySelector(".delete").addEventListener("click",()=>{r.remove(),delete o.comments[t.parentCounter]}),r.querySelector(".edit").addEventListener("click",()=>{L(r)}),r.querySelector(".cancel").addEventListener("click",()=>{r.querySelector(".comment-text").innerText=t.text,i(r)}),r.querySelector(".submit").addEventListener("click",()=>{const c=r.querySelector(".comment-text").innerText;c&&(t.text=c,r.querySelector(".comment-text").innerText=c,i(r))})),r}function f(e,t){e.querySelector(":scope > .sub-comments").appendChild(x());const o=e.querySelector(":scope > .sub-comments > .comment-wrapper:last-child");o.classList.add("new-comment"),o.querySelector(".cancel").addEventListener("click",()=>{o.remove()}),o.querySelector(".submit").addEventListener("click",()=>{const r=o.querySelector(".username-input").value,c=o.querySelector(".comment-text").innerText;if(!r||!c)return;const u={username:r,text:c,counter:0,parentCounter:t.counter,comments:{}};l(e,u,t),t.comments[t.counter++]=u,o.remove()})}function y(e,t){for(const o of Object.values(t.comments)){const r=l(e,o,t);o.comments&&y(r,o)}}function q(e=s){a.querySelector(".sub-comments").innerHTML="",n=e;const t=l(a,n);y(t,n)}v.addEventListener("click",()=>q());window.addEventListener("beforeunload",()=>{localStorage.setItem("state",JSON.stringify(n))});q(S);
